import{B as e,D as t,E as n,F as ee,G as r,H as te,J as ne,L as i,M as a,O as o,Q as s,S as re,T as c,V as l,X as u,d as ie,l as ae,o as d,p as f,v as p,w as m,y as oe,z as h}from"./index-6BYkH0DY.js";import{b as se}from"./AppHeader-BKR7rNi1.js";import"./LanguageSwitcher-Bwn7UERh.js";const ce={class:`min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-300`},le={class:`w-full py-8 px-4 sm:px-6 lg:px-8`},ue={class:`max-w-2xl mx-auto`},de={class:`bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 sm:p-8`},fe={class:`bg-gray-50 dark:bg-gray-700/50 rounded-lg p-6`},pe={class:`relative`},me={key:0,class:`absolute z-10 w-full mt-1 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg max-h-60 overflow-auto`},he=[`onMousedown`],g={class:`font-medium text-gray-900 dark:text-white`},_={class:`text-sm text-gray-500 dark:text-gray-400`},v={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},y={class:`bg-gray-50 dark:bg-gray-700/50 rounded-lg p-6`},b={class:`relative`},x={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},S={class:`bg-gray-50 dark:bg-gray-700/50 rounded-lg p-6`},C={class:`space-y-4`},w=[`value`],T={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},E={key:0},D=[`value`],O={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},k={key:1},A=[`value`],j={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},M={key:2,class:`p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg`},N={class:`text-blue-700 dark:text-blue-300`},P={class:`pt-6`},F=[`disabled`],I={key:0,class:`flex items-center justify-center`},L={key:1,class:`flex items-center justify-center`},R={key:0,class:`p-4 bg-green-100 dark:bg-green-900 border border-green-400 dark:border-green-600 text-green-700 dark:text-green-300 rounded-lg`},ge={key:1,class:`p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-600 text-red-700 dark:text-red-300 rounded-lg`},_e={__name:`NewBatchForm`,setup(_e){let z=ie();ae();let B=re({customer_id:``,unit_price:``,room_id:``,floor_id:``,zone_id:``}),V=c(``),H=c([]),U=c([]),W=c(null),G=c(!1),K=c([]),q=c([]),J=c([]),Y=c(``),X=c(!1),Z=c({}),Q=c(``),$=c(``);ne(async()=>{try{let[e,t]=await Promise.all([f.getCustomers(),d.getStorageStructure()]);H.value=e.data.data.data,K.value=t.data.data}catch(e){console.error(`Error loading data:`,e)}});let ve=()=>{if(!V.value.trim()){U.value=[];return}let e=V.value.toLowerCase();U.value=H.value.filter(t=>t.full_name.toLowerCase().includes(e)||t.cnic_number.toLowerCase().includes(e))},ye=e=>{W.value=e,B.customer_id=e.id,V.value=e.full_name,G.value=!1},be=()=>{setTimeout(()=>{G.value=!1},200)},xe=()=>{if(B.floor_id=``,B.zone_id=``,q.value=[],J.value=[],Y.value=``,B.room_id){let e=K.value.find(e=>e.id==B.room_id);e&&(q.value=e.floors)}},Se=()=>{if(B.zone_id=``,J.value=[],Y.value=``,B.floor_id){let e=q.value.find(e=>e.id==B.floor_id);e&&(J.value=e.zones)}},Ce=()=>{if(B.room_id&&B.floor_id&&B.zone_id){let e=K.value.find(e=>e.id==B.room_id),t=q.value.find(e=>e.id==B.floor_id),n=J.value.find(e=>e.id==B.zone_id);e&&t&&n&&(Y.value=`${e.name} - ${t.name} - ${n.name}`)}else Y.value=``};o(()=>B.zone_id,Ce);let we=async()=>{if(X.value=!0,Z.value={},Q.value=``,$.value=``,B.customer_id||(Z.value.customer_id=`Please select a customer`),(!B.unit_price||B.unit_price<=0)&&(Z.value.unit_price=`Please enter a valid unit price`),B.room_id||(Z.value.room_id=`Please select a room`),B.floor_id||(Z.value.floor_id=`Please select a floor`),B.zone_id||(Z.value.zone_id=`Please select a zone`),Object.keys(Z.value).length>0){X.value=!1;return}try{let e=await d.createBatch(B),t=e.data.data.batch;Q.value=`Lot created successfully! Redirecting to barcode scanner...`,Object.keys(B).forEach(e=>{B[e]=``}),V.value=``,W.value=null,q.value=[],J.value=[],Y.value=``,setTimeout(()=>{z.push(`/scanner?batchId=${t.id}`)},2e3)}catch(e){console.error(`Error creating batch:`,e),$.value=e.response?.data?.message||`Failed to create lot. Please try again.`}finally{X.value=!1}};return(ne,o)=>(i(),n(`div`,ce,[te(se,{"show-back":!0}),e(`div`,le,[e(`div`,ue,[o[21]||=ee(`<div class="text-center mb-8"><h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-2">Add New Lot</h2><p class="text-gray-600 dark:text-gray-400">Create a new lot record and start scanning baskets immediately</p><div class="mt-4 inline-flex items-center px-4 py-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg"><svg class="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="text-sm text-blue-700 dark:text-blue-300">After creating the lot, you&#39;ll be redirected to scan baskets</span></div></div>`,1),e(`div`,de,[e(`form`,{onSubmit:oe(we,[`prevent`]),class:`space-y-8`},[e(`div`,fe,[o[7]||=e(`h3`,{class:`text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center`},[e(`svg`,{class:`w-5 h-5 mr-2 text-blue-600`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[e(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z`})]),r(` Customer Information `)],-1),e(`div`,null,[o[6]||=e(`label`,{for:`customer_search`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Select Customer * `,-1),e(`div`,pe,[s(e(`input`,{"onUpdate:modelValue":o[0]||=e=>V.value=e,onInput:ve,onFocus:o[1]||=e=>G.value=!0,onBlur:be,type:`text`,id:`customer_search`,class:l([`w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":Z.value.customer_id}]),placeholder:`Search customer by name or CNIC...`},null,34),[[m,V.value]]),G.value&&U.value.length>0?(i(),n(`div`,me,[(i(!0),n(h,null,a(U.value,t=>(i(),n(`div`,{key:t.id,onMousedown:e=>ye(t),class:`px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer border-b border-gray-200 dark:border-gray-600 last:border-b-0`},[e(`div`,g,u(t.full_name),1),e(`div`,_,u(t.cnic_number),1)],40,he))),128))])):t(``,!0)]),Z.value.customer_id?(i(),n(`p`,v,u(Z.value.customer_id),1)):t(``,!0)])]),e(`div`,y,[o[10]||=e(`h3`,{class:`text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center`},[e(`svg`,{class:`w-5 h-5 mr-2 text-green-600`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[e(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4`})]),r(` Lot Details `)],-1),e(`div`,null,[o[9]||=e(`label`,{for:`unit_price`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Unit Price (PKR) * `,-1),e(`div`,b,[o[8]||=e(`div`,{class:`absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none`},[e(`span`,{class:`text-gray-500 dark:text-gray-400 text-sm`},`PKR`)],-1),s(e(`input`,{"onUpdate:modelValue":o[2]||=e=>B.unit_price=e,type:`number`,step:`0.01`,min:`0`,id:`unit_price`,class:l([`w-full pl-12 pr-3 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":Z.value.unit_price}]),placeholder:`0.00`},null,2),[[m,B.unit_price]])]),Z.value.unit_price?(i(),n(`p`,x,u(Z.value.unit_price),1)):t(``,!0)])]),e(`div`,S,[o[18]||=e(`h3`,{class:`text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center`},[e(`svg`,{class:`w-5 h-5 mr-2 text-purple-600`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[e(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4`})]),r(` Storage Location * `)],-1),e(`div`,C,[e(`div`,null,[o[12]||=e(`label`,{for:`room_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Room * `,-1),s(e(`select`,{"onUpdate:modelValue":o[3]||=e=>B.room_id=e,onChange:xe,id:`room_id`,class:l([`w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":Z.value.room_id}])},[o[11]||=e(`option`,{value:``},`Select Room`,-1),(i(!0),n(h,null,a(K.value,e=>(i(),n(`option`,{key:e.id,value:e.id},u(e.name)+` (`+u(e.code)+`) - `+u(e.available_capacity)+` baskets available `,9,w))),128))],34),[[p,B.room_id]]),Z.value.room_id?(i(),n(`p`,T,u(Z.value.room_id),1)):t(``,!0)]),B.room_id?(i(),n(`div`,E,[o[14]||=e(`label`,{for:`floor_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Floor * `,-1),s(e(`select`,{"onUpdate:modelValue":o[4]||=e=>B.floor_id=e,onChange:Se,id:`floor_id`,class:l([`w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":Z.value.floor_id}])},[o[13]||=e(`option`,{value:``},`Select Floor`,-1),(i(!0),n(h,null,a(q.value,e=>(i(),n(`option`,{key:e.id,value:e.id},u(e.name)+` - `+u(e.available_capacity)+` baskets available `,9,D))),128))],34),[[p,B.floor_id]]),Z.value.floor_id?(i(),n(`p`,O,u(Z.value.floor_id),1)):t(``,!0)])):t(``,!0),B.floor_id?(i(),n(`div`,k,[o[16]||=e(`label`,{for:`zone_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Zone * `,-1),s(e(`select`,{"onUpdate:modelValue":o[5]||=e=>B.zone_id=e,id:`zone_id`,class:l([`w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":Z.value.zone_id}])},[o[15]||=e(`option`,{value:``},`Select Zone`,-1),(i(!0),n(h,null,a(J.value,e=>(i(),n(`option`,{key:e.id,value:e.id},u(e.name)+` (`+u(e.code)+`) - `+u(e.available_capacity)+` baskets available `,9,A))),128))],2),[[p,B.zone_id]]),Z.value.zone_id?(i(),n(`p`,j,u(Z.value.zone_id),1)):t(``,!0)])):t(``,!0),Y.value?(i(),n(`div`,M,[o[17]||=e(`h4`,{class:`font-medium text-blue-900 dark:text-blue-100 mb-2`},`Selected Storage Location:`,-1),e(`p`,N,u(Y.value),1)])):t(``,!0)])]),e(`div`,P,[e(`button`,{type:`submit`,disabled:X.value,class:`w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-4 px-6 rounded-lg hover:from-blue-600 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium text-lg shadow-lg hover:shadow-xl`},[X.value?(i(),n(`span`,I,[...o[19]||=[e(`svg`,{class:`animate-spin -ml-1 mr-3 h-5 w-5 text-white`,xmlns:`http://www.w3.org/2000/svg`,fill:`none`,viewBox:`0 0 24 24`},[e(`circle`,{class:`opacity-25`,cx:`12`,cy:`12`,r:`10`,stroke:`currentColor`,"stroke-width":`4`}),e(`path`,{class:`opacity-75`,fill:`currentColor`,d:`M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z`})],-1),r(` Creating Lot & Preparing Scanner... `,-1)]])):(i(),n(`span`,L,[...o[20]||=[e(`svg`,{class:`w-5 h-5 mr-2`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[e(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M12 6v6m0 0v6m0-6h6m-6 0H6`})],-1),r(` Create Lot & Start Scanning `,-1)]]))],8,F)]),Q.value?(i(),n(`div`,R,u(Q.value),1)):t(``,!0),$.value?(i(),n(`div`,ge,u($.value),1)):t(``,!0)],32)])])]),o[22]||=e(`footer`,{class:`bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-16`},[e(`div`,{class:`max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8`},[e(`p`,{class:`text-center text-sm text-gray-500 dark:text-gray-400`},` Powered by Emeriosoft `)])],-1)]))}};var z=_e;export{z as default};