import{A as e,B as t,D as n,E as r,G as i,H as a,J as o,L as s,M as c,T as l,X as u,c as d,d as f,l as p,z as m}from"./index-6BYkH0DY.js";import{b as h}from"./AppHeader-BKR7rNi1.js";import"./LanguageSwitcher-Bwn7UERh.js";const g={class:`min-h-screen bg-gradient-to-br from-gray-50 via-gray-100 to-gray-200 dark:from-gray-900 dark:via-gray-800 dark:to-gray-700 transition-colors duration-300`},_={class:`w-full py-8 px-[2%]`},v={class:`w-full`},y={class:`mb-8`},b={class:`flex items-center justify-between`},x={class:`text-gray-600 dark:text-gray-400`},S=[`disabled`],C={class:`bg-white dark:bg-gray-800 rounded-lg shadow-md p-6`},w={key:0,class:`mb-8 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg`},T={class:`flex items-center`},E={class:`h-12 w-12 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold text-lg`},D={class:`ml-4`},O={class:`text-lg font-semibold text-gray-900 dark:text-gray-100`},k={class:`text-sm text-gray-600 dark:text-gray-400`},A={class:`mb-8`},j={key:0,class:`flex flex-wrap gap-2`},M=[`onClick`],N={key:1,class:`text-gray-500 dark:text-gray-400`},P={key:0,class:`grid gap-3`},F={class:`font-medium text-gray-900 dark:text-gray-100`},I={class:`text-sm text-gray-600 dark:text-gray-400`},L=[`onClick`],R={key:1,class:`text-gray-500 dark:text-gray-400`},z={key:1,class:`text-center py-8`},B={__name:`UserRoles`,setup(B){let V=d(),H=f(),U=p(),W=l(null),G=l([]),K=l([]),q=l(!1),J=e(()=>{let e=G.value.map(e=>e.id);return K.value.filter(t=>!e.includes(t.id))}),Y=async()=>{try{q.value=!0;let e=V.params.id,t=await fetch(`/api/user-management/${e}`,{headers:{Authorization:`Bearer ${U.token}`,"Content-Type":`application/json`}});if(t.ok){let e=await t.json();W.value=e.data,G.value=e.data.roles||[]}else alert(`Failed to load user data`)}catch(e){console.error(`Error loading user:`,e),alert(`Error loading user data`)}finally{q.value=!1}},X=async()=>{try{let e=await fetch(`/api/user-management/roles/available`,{headers:{Authorization:`Bearer ${U.token}`,"Content-Type":`application/json`}});if(e.ok){let t=await e.json();K.value=t.data||[]}}catch(e){console.error(`Error loading roles:`,e)}},Z=e=>{G.value.find(t=>t.id===e.id)||G.value.push(e)},Q=e=>{let t=G.value.findIndex(t=>t.id===e.id);t>-1&&G.value.splice(t,1)},$=async()=>{try{q.value=!0;let e=V.params.id,t=G.value.map(e=>e.id),n=await fetch(`/api/users/${e}/roles/sync`,{method:`POST`,headers:{Authorization:`Bearer ${U.token}`,"Content-Type":`application/json`},body:JSON.stringify({role_ids:t})});if(n.ok)alert(`User roles updated successfully!`),H.push(`/user-management`);else{let e=await n.json();alert(`Error: ${e.message||`Failed to update user roles`}`)}}catch(e){console.error(`Error saving user roles:`,e),alert(`Error saving user roles`)}finally{q.value=!1}};return o(()=>{Y(),X()}),(e,o)=>(s(),r(`div`,g,[a(h,{"show-back":!0}),t(`main`,_,[t(`div`,v,[t(`div`,y,[t(`div`,b,[t(`div`,null,[o[0]||=t(`h1`,{class:`text-3xl font-bold text-gray-900 dark:text-gray-100 mb-2`},`Manage User Roles`,-1),t(`p`,x,`Assign and manage roles for `+u(W.value?.name||`User`),1)]),t(`button`,{onClick:$,disabled:q.value,class:`bg-gradient-to-r from-green-400 to-green-500 hover:from-green-500 hover:to-green-600 disabled:opacity-50 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 flex items-center`},[...o[1]||=[t(`svg`,{class:`h-5 w-5 mr-2`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`},[t(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M5 13l4 4L19 7`})],-1),i(` Save Changes `,-1)]],8,S)])]),t(`div`,C,[W.value?(s(),r(`div`,w,[t(`div`,T,[t(`div`,E,u(W.value.name.charAt(0).toUpperCase()),1),t(`div`,D,[t(`h3`,O,u(W.value.name),1),t(`p`,k,u(W.value.email),1)])])])):n(``,!0),t(`div`,A,[o[3]||=t(`h3`,{class:`text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4`},`Current Roles`,-1),G.value.length>0?(s(),r(`div`,j,[(s(!0),r(m,null,c(G.value,e=>(s(),r(`span`,{key:e.id,class:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200`},[i(u(e.name)+` `,1),t(`button`,{onClick:t=>Q(e),class:`ml-2 text-blue-600 hover:text-blue-800 dark:text-blue-400`},[...o[2]||=[t(`svg`,{class:`h-4 w-4`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`},[t(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M6 18L18 6M6 6l12 12`})],-1)]],8,M)]))),128))])):(s(),r(`div`,N,` No roles assigned `))]),t(`div`,null,[o[4]||=t(`h3`,{class:`text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4`},`Available Roles`,-1),J.value.length>0?(s(),r(`div`,P,[(s(!0),r(m,null,c(J.value,e=>(s(),r(`div`,{key:e.id,class:`flex items-center justify-between p-4 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700`},[t(`div`,null,[t(`h4`,F,u(e.name),1),t(`p`,I,u(e.description),1)]),t(`button`,{onClick:t=>Z(e),class:`bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors`},` Add Role `,8,L)]))),128))])):(s(),r(`div`,R,` No available roles `))]),q.value?(s(),r(`div`,z,[...o[5]||=[t(`div`,{class:`inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500`},null,-1),t(`p`,{class:`mt-2 text-gray-600 dark:text-gray-400`},`Loading...`,-1)]])):n(``,!0)])])])]))}};var V=B;export{V as default};