import{B as e,D as t,E as n,G as r,H as i,J as ee,L as a,M as o,Q as te,T as s,V as c,X as l,d as ne,o as re,q as u,w as ie,z as d}from"./index-6BYkH0DY.js";import{b as ae}from"./AppHeader-BKR7rNi1.js";import"./LanguageSwitcher-Bwn7UERh.js";import{b as oe}from"./BarcodeScannerIntegration-D1iYSDQG.js";const se={class:`min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-300`},ce={class:`w-full py-8 px-4 sm:px-6 lg:px-8`},le={class:`max-w-4xl mx-auto`},ue={class:`bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-6`},de={class:`grid grid-cols-1 md:grid-cols-2 gap-4`},fe={key:0,class:`p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg`},pe={class:`flex justify-between items-center`},f={class:`font-medium text-blue-900 dark:text-blue-100`},p={class:`text-sm text-blue-700 dark:text-blue-300`},m={class:`text-xs text-blue-600 dark:text-blue-400`},h={key:1,class:`p-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-center`},g={key:0,class:`mt-4 max-h-60 overflow-y-auto border border-gray-200 dark:border-gray-600 rounded-lg`},_=[`onClick`],v={class:`flex justify-between items-center`},y={class:`font-medium text-gray-900 dark:text-white`},b={class:`text-sm text-gray-600 dark:text-gray-400`},x={class:`text-xs text-gray-500 dark:text-gray-500`},S={class:`text-right`},C={key:0,class:`bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-6`},w={class:`mb-4`},T={class:`text-sm text-gray-600 dark:text-gray-400`},E={class:`grid grid-cols-2 md:grid-cols-4 gap-4 mb-6`},D={class:`bg-white dark:bg-gray-800 rounded-lg p-4 text-center`},O={class:`text-2xl font-bold text-green-600`},k={class:`bg-white dark:bg-gray-800 rounded-lg p-4 text-center`},A={class:`text-2xl font-bold text-yellow-600`},j={class:`bg-white dark:bg-gray-800 rounded-lg p-4 text-center`},M={class:`text-2xl font-bold text-blue-600`},N={class:`bg-white dark:bg-gray-800 rounded-lg p-4 text-center`},P={class:`text-2xl font-bold text-purple-600`},F={class:`bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6`},I={key:0,class:`text-center py-8`},L={key:1,class:`space-y-3`},R={class:`flex items-center space-x-3`},z={class:`text-sm font-medium text-gray-900 dark:text-white`},B={class:`text-xs text-gray-500 dark:text-gray-400`},me={class:`text-right`},he={class:`text-xs text-gray-500 dark:text-gray-400 mt-1`},ge={key:0,class:`fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50`},V={class:`relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white dark:bg-gray-800`},_e={class:`mt-3`},ve={key:0,class:`h-6 w-6 text-green-600`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`},ye={key:1,class:`h-6 w-6 text-red-600`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`},be={class:`mt-2 px-7 py-3`},xe={class:`text-lg font-medium text-gray-900 dark:text-white text-center`},Se={class:`mt-2 px-1 py-3`},Ce={class:`text-sm text-gray-500 dark:text-gray-400 text-center`},we={key:0,class:`mt-4 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg`},Te={class:`text-xs text-gray-600 dark:text-gray-400`},Ee={class:`text-xs text-gray-600 dark:text-gray-400`},De={class:`text-xs text-gray-600 dark:text-gray-400`},Oe={__name:`DispatchScanner`,setup(Oe){let H=ne(),U=s({}),W=s([]),G=s(!1),K=s({}),q=s(null),J=s(``),Y=s([]),X=s(null);ee(async()=>{await Z(),await Q()});let Z=async()=>{try{let e=await u.getStats();U.value=e.data.data}catch(e){console.error(`Error loading stats:`,e)}},Q=async()=>{try{let e=await u.getHistory({per_page:5});W.value=e.data.data.data||[]}catch(e){console.error(`Error loading recent dispatches:`,e)}},ke=async()=>{X.value&&clearTimeout(X.value),X.value=setTimeout(async()=>{if(J.value.length<2){Y.value=[];return}try{let e=await re.getBatches(1,J.value),t=e.data.data?.data||e.data.data||[];Y.value=t.filter(e=>e.status===`active`)}catch(e){console.error(`Error searching lots:`,e),Y.value=[]}},300)},Ae=e=>{q.value=e,Y.value=[],J.value=``},je=()=>{q.value=null},Me=e=>{let t={active:`bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300`,expired:`bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300`,completed:`bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300`};return t[e]||`bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300`},$=e=>new Intl.NumberFormat(`en-PK`).format(e),Ne=()=>{H.push(`/dispatch-history`)},Pe=async e=>{if(!q.value){K.value={success:!1,message:`Please select a lot before scanning baskets`},G.value=!0;return}console.log(`Dispatching barcode:`,e.code,`for lot:`,q.value.id);try{let t=await u.dispatchByBarcode({barcode:e.code,lot_id:q.value.id,dispatch_notes:`Scanned at ${new Date().toLocaleString()} for Lot #${q.value.id}`});K.value=t.data,G.value=!0,await Z(),await Q(),Be()}catch(e){console.error(`Dispatch error:`,e),K.value={success:!1,message:e.response?.data?.message||`Failed to dispatch basket`},G.value=!0}},Fe=e=>{console.log(`Searching for barcode:`,e.code)},Ie=e=>{console.log(`Creating with barcode:`,e.code)},Le=()=>{G.value=!1,K.value={}},Re=e=>{let t={pending:`bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300`,approved:`bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300`,dispatched:`bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300`,cancelled:`bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300`};return t[e]||`bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300`},ze=e=>{if(!e)return`N/A`;let t=new Date(e);return t.toLocaleDateString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`,hour:`2-digit`,minute:`2-digit`})},Be=()=>{let e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),n=e.createGain();t.connect(n),n.connect(e.destination),t.frequency.setValueAtTime(800,e.currentTime),t.frequency.setValueAtTime(600,e.currentTime+.1),n.gain.setValueAtTime(.3,e.currentTime),n.gain.exponentialRampToValueAtTime(.01,e.currentTime+.2),t.start(e.currentTime),t.stop(e.currentTime+.2)};return(ee,s)=>(a(),n(`div`,se,[i(ae,{title:`Fast Dispatch`,"show-back":!0}),e(`div`,ce,[e(`div`,le,[s[14]||=e(`div`,{class:`text-center mb-8`},[e(`h2`,{class:`text-3xl font-bold text-gray-900 dark:text-white mb-2`},`Fast Dispatch Scanner`),e(`p`,{class:`text-gray-600 dark:text-gray-400`},`Scan barcodes to dispatch baskets instantly`)],-1),e(`div`,ue,[s[5]||=e(`div`,{class:`mb-4`},[e(`h3`,{class:`text-lg font-semibold text-gray-900 dark:text-white mb-2`},`Select Lot for Dispatch`),e(`p`,{class:`text-sm text-gray-600 dark:text-gray-400`},`Choose the lot that contains the baskets you want to dispatch`)],-1),e(`div`,de,[e(`div`,null,[s[1]||=e(`label`,{class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Search Lot `,-1),te(e(`input`,{"onUpdate:modelValue":s[0]||=e=>J.value=e,type:`text`,placeholder:`Search by Lot ID, Customer, or Batch Number`,class:`w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white`,onInput:ke},null,544),[[ie,J.value]])]),e(`div`,null,[s[4]||=e(`label`,{class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Selected Lot `,-1),q.value?(a(),n(`div`,fe,[e(`div`,pe,[e(`div`,null,[e(`p`,f,`Lot #`+l(q.value.id),1),e(`p`,p,l(q.value.customer?.full_name),1),e(`p`,m,l(q.value.total_baskets)+` baskets • PKR `+l($(q.value.total_value)),1)]),e(`button`,{onClick:je,class:`text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300`},[...s[2]||=[e(`svg`,{class:`w-5 h-5`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`},[e(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M6 18L18 6M6 6l12 12`})],-1)]])])])):(a(),n(`div`,h,[...s[3]||=[e(`p`,{class:`text-gray-500 dark:text-gray-400 text-sm`},`No lot selected`,-1)]]))])]),Y.value.length>0?(a(),n(`div`,g,[(a(!0),n(d,null,o(Y.value,t=>(a(),n(`div`,{key:t.id,onClick:e=>Ae(t),class:`p-3 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer border-b border-gray-200 dark:border-gray-600 last:border-b-0`},[e(`div`,v,[e(`div`,null,[e(`p`,y,`Lot #`+l(t.id),1),e(`p`,b,l(t.customer?.full_name),1),e(`p`,x,l(t.total_baskets)+` baskets • PKR `+l($(t.total_value)),1)]),e(`div`,S,[e(`span`,{class:c([`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium`,Me(t.status)])},l(t.status),3)])])],8,_))),128))])):t(``,!0)]),q.value?(a(),n(`div`,C,[e(`div`,w,[s[6]||=e(`h3`,{class:`text-lg font-semibold text-gray-900 dark:text-white mb-2`},`Scan Baskets for Dispatch`,-1),e(`p`,T,`Scan barcodes to dispatch baskets from Lot #`+l(q.value.id),1)]),i(oe,{"on-scan":Pe,"on-search":Fe,"on-create":Ie})])):t(``,!0),e(`div`,E,[e(`div`,D,[e(`div`,O,l(U.value.completed_dispatches||0),1),s[7]||=e(`div`,{class:`text-sm text-gray-600 dark:text-gray-400`},`Completed`,-1)]),e(`div`,k,[e(`div`,A,l(U.value.pending_approvals||0),1),s[8]||=e(`div`,{class:`text-sm text-gray-600 dark:text-gray-400`},`Pending`,-1)]),e(`div`,j,[e(`div`,M,l(U.value.today_dispatches||0),1),s[9]||=e(`div`,{class:`text-sm text-gray-600 dark:text-gray-400`},`Today`,-1)]),e(`div`,N,[e(`div`,P,l(U.value.total_dispatches||0),1),s[10]||=e(`div`,{class:`text-sm text-gray-600 dark:text-gray-400`},`Total`,-1)])]),e(`div`,F,[e(`div`,{class:`flex justify-between items-center mb-4`},[s[11]||=e(`h3`,{class:`text-lg font-semibold text-gray-900 dark:text-white`},`Recent Dispatches`,-1),e(`button`,{onClick:Ne,class:`text-blue-600 hover:text-blue-800 text-sm font-medium`},` View All `)]),W.value.length===0?(a(),n(`div`,I,[...s[12]||=[e(`svg`,{class:`mx-auto h-12 w-12 text-gray-400`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`},[e(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4`})],-1),e(`p`,{class:`mt-2 text-sm text-gray-500 dark:text-gray-400`},`No recent dispatches`,-1)]])):(a(),n(`div`,L,[(a(!0),n(d,null,o(W.value,t=>(a(),n(`div`,{key:t.id,class:`flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg`},[e(`div`,R,[s[13]||=e(`div`,{class:`flex-shrink-0`},[e(`div`,{class:`h-8 w-8 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center`},[e(`svg`,{class:`h-4 w-4 text-blue-600 dark:text-blue-400`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`},[e(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4`})])])],-1),e(`div`,null,[e(`p`,z,l(t.dispatch_number),1),e(`p`,B,l(t.barcode)+` • `+l(t.customer?.full_name),1)])]),e(`div`,me,[e(`span`,{class:c([Re(t.status),`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium`])},l(t.status),3),e(`p`,he,l(ze(t.created_at)),1)])]))),128))]))])])]),G.value?(a(),n(`div`,ge,[e(`div`,V,[e(`div`,_e,[e(`div`,{class:c([`mx-auto flex items-center justify-center h-12 w-12 rounded-full`,K.value.success?`bg-green-100`:`bg-red-100`])},[K.value.success?(a(),n(`svg`,ve,[...s[15]||=[e(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M5 13l4 4L19 7`},null,-1)]])):(a(),n(`svg`,ye,[...s[16]||=[e(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M6 18L18 6M6 6l12 12`},null,-1)]]))],2),e(`div`,be,[e(`h3`,xe,l(K.value.success?`Dispatch Successful!`:`Dispatch Failed`),1),e(`div`,Se,[e(`p`,Ce,l(K.value.message),1),K.value.data?(a(),n(`div`,we,[e(`p`,Te,[s[17]||=e(`strong`,null,`Dispatch #:`,-1),r(` `+l(K.value.data.dispatch_record?.dispatch_number),1)]),e(`p`,Ee,[s[18]||=e(`strong`,null,`Customer:`,-1),r(` `+l(K.value.data.dispatch_record?.customer?.full_name),1)]),e(`p`,De,[s[19]||=e(`strong`,null,`Status:`,-1),r(` `+l(K.value.data.requires_approval?`Pending Approval`:`Auto-Approved`),1)])])):t(``,!0)])]),e(`div`,{class:`items-center px-4 py-3`},[e(`button`,{onClick:Le,class:`px-4 py-2 bg-blue-500 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-300`},` OK `)])])])])):t(``,!0)]))}};var H=Oe;export{H as default};