import{A as e,B as t,D as n,E as r,F as ee,H as i,I as a,J as o,K as s,L as te,M as c,O as l,P as u,Q as d,R as f,T as p,d as ne,l as re,o as m,p as ie,t as h,u as g,w as ae,x as _,z as v}from"./index-BewjDgXt.js";import{b as oe}from"./useDarkMode-v5Dqi2be.js";import{b as se}from"./MegaSearch-brGl_kL4.js";import{b as ce}from"./LanguageSwitcher-ZKeWbNQ2.js";const le={class:`min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-300`},ue={class:`bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700`},de={class:`w-full px-[2%]`},fe={class:`flex justify-between items-center h-16`},pe={class:`flex items-center space-x-4`},me={class:`hidden md:block w-80`},he={key:0,class:`h-5 w-5`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`},ge={key:1,class:`h-5 w-5`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`},y={class:`w-full py-8 px-[2%]`},b={class:`mb-6`},x={class:`bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8`},S={class:`relative`},C={key:0,class:`absolute z-10 w-full mt-1 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg max-h-60 overflow-auto`},w=[`onMousedown`],T={class:`font-medium text-gray-900 dark:text-white`},E={class:`text-sm text-gray-500 dark:text-gray-400`},D={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},O={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},k={class:`space-y-4`},A=[`value`],j={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},M={key:0},N=[`value`],P={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},F={key:1},I=[`value`],L={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},_e={key:2,class:`p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg`},ve={class:`text-blue-700 dark:text-blue-300`},ye={class:`pt-4`},be=[`disabled`],xe={key:0,class:`flex items-center justify-center`},Se={key:1},Ce={key:0,class:`p-4 bg-green-100 dark:bg-green-900 border border-green-400 dark:border-green-600 text-green-700 dark:text-green-300 rounded-lg`},we={key:1,class:`p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-600 text-red-700 dark:text-red-300 rounded-lg`},Te={__name:`NewBatchForm`,setup(Te){let R=ne(),Ee=re(),{isDarkMode:De,toggleDarkMode:z}=oe(),B=l({customer_id:``,unit_price:``,room_id:``,floor_id:``,zone_id:``}),V=u(``),H=u([]),U=u([]),W=u(null),G=u(!1),K=u([]),q=u([]),J=u([]),Y=u(``),X=u(!1),Z=u({}),Q=u(``),$=u(``);ee(async()=>{try{let[e,t]=await Promise.all([ie.getCustomers(),m.getStorageStructure()]);H.value=e.data.data.data,K.value=t.data.data}catch(e){console.error(`Error loading data:`,e)}});let Oe=()=>{if(!V.value.trim()){U.value=[];return}let e=V.value.toLowerCase();U.value=H.value.filter(t=>t.full_name.toLowerCase().includes(e)||t.cnic_number.toLowerCase().includes(e))},ke=e=>{W.value=e,B.customer_id=e.id,V.value=e.full_name,G.value=!1},Ae=()=>{setTimeout(()=>{G.value=!1},200)},je=()=>{if(B.floor_id=``,B.zone_id=``,q.value=[],J.value=[],Y.value=``,B.room_id){let e=K.value.find(e=>e.id==B.room_id);e&&(q.value=e.floors)}},Me=()=>{if(B.zone_id=``,J.value=[],Y.value=``,B.floor_id){let e=q.value.find(e=>e.id==B.floor_id);e&&(J.value=e.zones)}},Ne=()=>{if(B.room_id&&B.floor_id&&B.zone_id){let e=K.value.find(e=>e.id==B.room_id),t=q.value.find(e=>e.id==B.floor_id),n=J.value.find(e=>e.id==B.zone_id);e&&t&&n&&(Y.value=`${e.name} - ${t.name} - ${n.name}`)}else Y.value=``};s(()=>B.zone_id,Ne);let Pe=async()=>{if(X.value=!0,Z.value={},Q.value=``,$.value=``,B.customer_id||(Z.value.customer_id=`Please select a customer`),(!B.unit_price||B.unit_price<=0)&&(Z.value.unit_price=`Please enter a valid unit price`),B.room_id||(Z.value.room_id=`Please select a room`),B.floor_id||(Z.value.floor_id=`Please select a floor`),B.zone_id||(Z.value.zone_id=`Please select a zone`),Object.keys(Z.value).length>0){X.value=!1;return}try{await m.createBatch(B),Q.value=`Lot created successfully!`,Object.keys(B).forEach(e=>{B[e]=``}),V.value=``,W.value=null,q.value=[],J.value=[],Y.value=``,setTimeout(()=>{R.push(`/dashboard`)},2e3)}catch(e){console.error(`Error creating batch:`,e),$.value=e.response?.data?.message||`Failed to create lot. Please try again.`}finally{X.value=!1}},Fe=()=>{Ee.logout(),R.push(`/login`)};return(ee,s)=>{let l=o(`router-link`);return i(),t(`div`,le,[v(`nav`,ue,[v(`div`,de,[v(`div`,fe,[s[9]||=v(`div`,{class:`flex items-center`},[v(`div`,{class:`flex-shrink-0`},[v(`h1`,{class:`text-2xl font-bold text-gray-900 dark:text-white`},`A & S Cold Storage`)])],-1),v(`div`,pe,[v(`div`,me,[r(se)]),v(`button`,{onClick:s[0]||=(...e)=>d(z)&&d(z)(...e),class:`p-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors duration-200`},[d(De)?(i(),t(`svg`,ge,[...s[8]||=[v(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z`},null,-1)]])):(i(),t(`svg`,he,[...s[7]||=[v(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z`},null,-1)]]))]),r(ce),v(`button`,{onClick:Fe,class:`px-4 py-2 bg-gradient-to-r from-red-400 to-red-500 text-white rounded-lg hover:from-red-500 hover:to-red-600 transition-all duration-200 font-medium`},` Logout `)])])])]),v(`div`,y,[v(`div`,b,[r(l,{to:`/dashboard`,class:`inline-flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors duration-200`},{default:te(()=>[...s[10]||=[v(`svg`,{class:`w-4 h-4 mr-2`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`},[v(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M10 19l-7-7m0 0l7-7m-7 7h18`})],-1),n(` Back to Dashboard `,-1)]]),_:1})]),s[22]||=v(`div`,{class:`text-center mb-8`},[v(`h2`,{class:`text-3xl font-bold text-gray-900 dark:text-white mb-2`},`Add New Lot`),v(`p`,{class:`text-gray-600 dark:text-gray-400`},`Create a new lot record for a customer`)],-1),v(`div`,x,[v(`form`,{onSubmit:ae(Pe,[`prevent`]),class:`space-y-6`},[v(`div`,null,[s[11]||=v(`label`,{for:`customer_search`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Customer * `,-1),v(`div`,S,[c(v(`input`,{"onUpdate:modelValue":s[1]||=e=>V.value=e,onInput:Oe,onFocus:s[2]||=e=>G.value=!0,onBlur:Ae,type:`text`,id:`customer_search`,class:f([`w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":Z.value.customer_id}]),placeholder:`Search customer by name or CNIC...`},null,34),[[g,V.value]]),G.value&&U.value.length>0?(i(),t(`div`,C,[(i(!0),t(_,null,a(U.value,e=>(i(),t(`div`,{key:e.id,onMousedown:t=>ke(e),class:`px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer border-b border-gray-200 dark:border-gray-600 last:border-b-0`},[v(`div`,T,p(e.full_name),1),v(`div`,E,p(e.cnic_number),1)],40,w))),128))])):e(``,!0)]),Z.value.customer_id?(i(),t(`p`,D,p(Z.value.customer_id),1)):e(``,!0)]),v(`div`,null,[s[12]||=v(`label`,{for:`unit_price`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Unit Price (PKR) * `,-1),c(v(`input`,{"onUpdate:modelValue":s[3]||=e=>B.unit_price=e,type:`number`,step:`0.01`,min:`0`,id:`unit_price`,class:f([`w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":Z.value.unit_price}]),placeholder:`Enter unit price in PKR`},null,2),[[g,B.unit_price]]),Z.value.unit_price?(i(),t(`p`,O,p(Z.value.unit_price),1)):e(``,!0)]),v(`div`,k,[s[20]||=v(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Storage Location *`,-1),v(`div`,null,[s[14]||=v(`label`,{for:`room_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Room * `,-1),c(v(`select`,{"onUpdate:modelValue":s[4]||=e=>B.room_id=e,onChange:je,id:`room_id`,class:f([`w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":Z.value.room_id}])},[s[13]||=v(`option`,{value:``},`Select Room`,-1),(i(!0),t(_,null,a(K.value,e=>(i(),t(`option`,{key:e.id,value:e.id},p(e.name)+` (`+p(e.code)+`) - `+p(e.available_capacity)+` baskets available `,9,A))),128))],34),[[h,B.room_id]]),Z.value.room_id?(i(),t(`p`,j,p(Z.value.room_id),1)):e(``,!0)]),B.room_id?(i(),t(`div`,M,[s[16]||=v(`label`,{for:`floor_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Floor * `,-1),c(v(`select`,{"onUpdate:modelValue":s[5]||=e=>B.floor_id=e,onChange:Me,id:`floor_id`,class:f([`w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":Z.value.floor_id}])},[s[15]||=v(`option`,{value:``},`Select Floor`,-1),(i(!0),t(_,null,a(q.value,e=>(i(),t(`option`,{key:e.id,value:e.id},p(e.name)+` - `+p(e.available_capacity)+` baskets available `,9,N))),128))],34),[[h,B.floor_id]]),Z.value.floor_id?(i(),t(`p`,P,p(Z.value.floor_id),1)):e(``,!0)])):e(``,!0),B.floor_id?(i(),t(`div`,F,[s[18]||=v(`label`,{for:`zone_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Zone * `,-1),c(v(`select`,{"onUpdate:modelValue":s[6]||=e=>B.zone_id=e,id:`zone_id`,class:f([`w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":Z.value.zone_id}])},[s[17]||=v(`option`,{value:``},`Select Zone`,-1),(i(!0),t(_,null,a(J.value,e=>(i(),t(`option`,{key:e.id,value:e.id},p(e.name)+` (`+p(e.code)+`) - `+p(e.available_capacity)+` baskets available `,9,I))),128))],2),[[h,B.zone_id]]),Z.value.zone_id?(i(),t(`p`,L,p(Z.value.zone_id),1)):e(``,!0)])):e(``,!0),Y.value?(i(),t(`div`,_e,[s[19]||=v(`h4`,{class:`font-medium text-blue-900 dark:text-blue-100 mb-2`},`Selected Storage Location:`,-1),v(`p`,ve,p(Y.value),1)])):e(``,!0)]),v(`div`,ye,[v(`button`,{type:`submit`,disabled:X.value,class:`w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 px-6 rounded-lg hover:from-blue-600 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium`},[X.value?(i(),t(`span`,xe,[...s[21]||=[v(`svg`,{class:`animate-spin -ml-1 mr-3 h-5 w-5 text-white`,xmlns:`http://www.w3.org/2000/svg`,fill:`none`,viewBox:`0 0 24 24`},[v(`circle`,{class:`opacity-25`,cx:`12`,cy:`12`,r:`10`,stroke:`currentColor`,"stroke-width":`4`}),v(`path`,{class:`opacity-75`,fill:`currentColor`,d:`M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z`})],-1),n(` Creating Lot... `,-1)]])):(i(),t(`span`,Se,`Create Lot`))],8,be)]),Q.value?(i(),t(`div`,Ce,p(Q.value),1)):e(``,!0),$.value?(i(),t(`div`,we,p($.value),1)):e(``,!0)],32)])]),s[23]||=v(`footer`,{class:`bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-16`},[v(`div`,{class:`max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8`},[v(`p`,{class:`text-center text-sm text-gray-500 dark:text-gray-400`},` Powered by Emeriosoft `)])],-1)])}}};var R=Te;export{R as default};