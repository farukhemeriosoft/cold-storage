import{B as e,D as t,E as n,G as r,H as ee,J as te,L as i,M as a,Q as o,T as s,V as ne,X as c,e as re,l as ie,u as ae,w as l,y as oe,z as u}from"./index-6BYkH0DY.js";import{b as se}from"./AppHeader-BKR7rNi1.js";import"./LanguageSwitcher-Bwn7UERh.js";const ce={class:`min-h-screen bg-gradient-to-br from-gray-50 via-gray-100 to-gray-200 dark:from-gray-900 dark:via-gray-800 dark:to-gray-700 transition-colors duration-300`},le={class:`w-full py-8 px-[2%]`},ue={class:`w-full`},de={class:`bg-white dark:bg-gray-800 rounded-lg shadow-md p-6`},fe={class:`mb-8`},d={class:`grid gap-4`},f={class:`flex justify-between items-start`},p={class:`font-semibold text-gray-800`},m={class:`text-sm text-gray-600`},h={class:`mt-2`},g={class:`inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded`},_={class:`flex space-x-2`},v=[`onClick`],y=[`onClick`],b=[`onClick`],x={key:0,class:`mt-3`},S={class:`flex flex-wrap gap-1`},C={key:0,class:`bg-gray-100 text-gray-700 text-xs px-2 py-1 rounded`},w={class:`grid gap-4`},T={class:`flex justify-between items-center`},E={class:`font-semibold text-gray-800`},D={class:`text-sm text-gray-600`},O={class:`flex items-center space-x-2`},k={class:`flex flex-wrap gap-1`},A=[`onClick`],j={key:0,class:`fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50`},M={class:`bg-white rounded-lg p-6 w-full max-w-md`},N={class:`text-lg font-semibold mb-4`},P={class:`mb-4`},F={class:`mb-4`},I={class:`mb-4`},L={class:`flex justify-end space-x-2`},R={type:`submit`,class:`px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600`},pe={key:1,class:`fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50`},z={class:`bg-white rounded-lg p-6 w-full max-w-2xl max-h-96 overflow-y-auto`},B={class:`text-lg font-semibold mb-4`},me={class:`grid grid-cols-2 gap-4`},he=[`id`,`value`],ge=[`for`],_e={class:`flex justify-end space-x-2 mt-6`},V={__name:`RoleManagement`,setup(re){let V=ie(),H=s([]),U=s([]),W=s([]),G=s(!1),K=s(!1),q=s(!1),J=s(null),Y=s([]),X=s({name:``,slug:``,description:``}),Z=async()=>{try{let e=await fetch(`/api/roles`,{headers:{Authorization:`Bearer ${V.token}`,"Content-Type":`application/json`}}),t=await e.json();H.value=t.data}catch(e){console.error(`Error loading roles:`,e)}},ve=async()=>{try{let e=await fetch(`/api/users`,{headers:{Authorization:`Bearer ${V.token}`,"Content-Type":`application/json`}}),t=await e.json();U.value=t.data}catch(e){console.error(`Error loading users:`,e)}},ye=async()=>{try{let e=await fetch(`/api/permissions`,{headers:{Authorization:`Bearer ${V.token}`,"Content-Type":`application/json`}}),t=await e.json();W.value=t.data}catch(e){console.error(`Error loading permissions:`,e)}},be=async()=>{try{let e=G.value?`/api/roles`:`/api/roles/${J.value.id}`,t=G.value?`POST`:`PUT`;G.value&&!X.value.slug&&(X.value.slug=X.value.name.toLowerCase().replace(/\s+/g,`_`));let n=await fetch(e,{method:t,headers:{Authorization:`Bearer ${V.token}`,"Content-Type":`application/json`},body:JSON.stringify(X.value)});if(n.ok)await Z(),$(),alert(G.value?`Role created successfully!`:`Role updated successfully!`);else{let e=await n.json();alert(`Error: ${e.message||`Failed to save role`}`)}}catch(e){console.error(`Error saving role:`,e),alert(`Error saving role. Please check console for details.`)}},xe=e=>{J.value=e,X.value={name:e.name,slug:e.slug,description:e.description||``},K.value=!0},Q=async e=>{if(confirm(`Are you sure you want to delete the role "${e.name}"?`))try{let t=await fetch(`/api/roles/${e.id}`,{method:`DELETE`,headers:{Authorization:`Bearer ${V.token}`,"Content-Type":`application/json`}});t.ok&&await Z()}catch(e){console.error(`Error deleting role:`,e)}},Se=e=>{J.value=e,Y.value=e.permissions?.map(e=>e.id)||[],q.value=!0},Ce=async()=>{try{let e=await fetch(`/api/roles/${J.value.id}/permissions`,{method:`POST`,headers:{Authorization:`Bearer ${V.token}`,"Content-Type":`application/json`},body:JSON.stringify({permissions:Y.value})});e.ok&&(await Z(),q.value=!1)}catch(e){console.error(`Error saving permissions:`,e)}},we=()=>{console.log(`Opening create role modal`),X.value={name:``,slug:``,description:``},G.value=!0},$=()=>{G.value=!1,K.value=!1,J.value=null,X.value={name:``,slug:``,description:``}},Te=e=>{console.log(`Manage roles for user:`,e)};return te(()=>{Z(),ve(),ye()}),(te,s)=>(i(),n(`div`,ce,[ee(se,{"show-back":!0}),e(`main`,le,[e(`div`,ue,[e(`div`,{class:`mb-8`},[e(`div`,{class:`flex items-center justify-between`},[s[6]||=e(`div`,null,[e(`h1`,{class:`text-3xl font-bold text-gray-900 dark:text-gray-100 mb-2`},`Role Management`),e(`p`,{class:`text-gray-600 dark:text-gray-400`},`Manage roles and permissions`)],-1),e(`button`,{onClick:we,class:`bg-gradient-to-r from-blue-400 to-blue-500 hover:from-blue-500 hover:to-blue-600 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 flex items-center`},[...s[5]||=[e(`svg`,{class:`h-5 w-5 mr-2`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`},[e(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M12 6v6m0 0v6m0-6h6m-6 0H6`})],-1),r(` Create Role `,-1)]])])]),e(`div`,de,[e(`div`,fe,[s[8]||=e(`h3`,{class:`text-lg font-semibold mb-4`},`Roles`,-1),e(`div`,d,[(i(!0),n(u,null,a(H.value,r=>(i(),n(`div`,{key:r.id,class:`border rounded-lg p-4 hover:shadow-md transition-shadow`},[e(`div`,f,[e(`div`,null,[e(`h4`,p,c(r.name),1),e(`p`,m,c(r.description),1),e(`div`,h,[e(`span`,g,c(r.slug),1),e(`span`,{class:ne([`inline-block text-xs px-2 py-1 rounded ml-2`,r.is_active?`bg-green-100 text-green-800`:`bg-red-100 text-red-800`])},c(r.is_active?`Active`:`Inactive`),3)])]),e(`div`,_,[e(`button`,{onClick:e=>xe(r),class:`text-blue-600 hover:text-blue-800 text-sm`},` Edit `,8,v),e(`button`,{onClick:e=>Se(r),class:`text-green-600 hover:text-green-800 text-sm`},` Permissions `,8,y),e(`button`,{onClick:e=>Q(r),class:`text-red-600 hover:text-red-800 text-sm`},` Delete `,8,b)])]),r.permissions&&r.permissions.length>0?(i(),n(`div`,x,[s[7]||=e(`div`,{class:`text-sm text-gray-600 mb-1`},`Permissions:`,-1),e(`div`,S,[(i(!0),n(u,null,a(r.permissions.slice(0,5),e=>(i(),n(`span`,{key:e.id,class:`bg-gray-100 text-gray-700 text-xs px-2 py-1 rounded`},c(e.name),1))),128)),r.permissions.length>5?(i(),n(`span`,C,` +`+c(r.permissions.length-5)+` more `,1)):t(``,!0)])])):t(``,!0)]))),128))])]),e(`div`,null,[s[9]||=e(`h3`,{class:`text-lg font-semibold mb-4`},`Users & Their Roles`,-1),e(`div`,w,[(i(!0),n(u,null,a(U.value,t=>(i(),n(`div`,{key:t.id,class:`border rounded-lg p-4`},[e(`div`,T,[e(`div`,null,[e(`h4`,E,c(t.name),1),e(`p`,D,c(t.email),1)]),e(`div`,O,[e(`div`,k,[(i(!0),n(u,null,a(t.roles,e=>(i(),n(`span`,{key:e.id,class:`bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded`},c(e.name),1))),128))]),e(`button`,{onClick:e=>Te(t),class:`text-blue-600 hover:text-blue-800 text-sm`},` Manage Roles `,8,A)])])]))),128))])])]),G.value||K.value?(i(),n(`div`,j,[e(`div`,M,[e(`h3`,N,c(G.value?`Create Role`:`Edit Role`),1),e(`form`,{onSubmit:oe(be,[`prevent`])},[e(`div`,P,[s[10]||=e(`label`,{class:`block text-sm font-medium text-gray-700 mb-2`},`Name`,-1),o(e(`input`,{"onUpdate:modelValue":s[0]||=e=>X.value.name=e,type:`text`,class:`w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500`,required:``},null,512),[[l,X.value.name]])]),e(`div`,F,[s[11]||=e(`label`,{class:`block text-sm font-medium text-gray-700 mb-2`},`Slug`,-1),o(e(`input`,{"onUpdate:modelValue":s[1]||=e=>X.value.slug=e,type:`text`,class:`w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500`,required:``},null,512),[[l,X.value.slug]])]),e(`div`,I,[s[12]||=e(`label`,{class:`block text-sm font-medium text-gray-700 mb-2`},`Description`,-1),o(e(`textarea`,{"onUpdate:modelValue":s[2]||=e=>X.value.description=e,class:`w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500`,rows:`3`},null,512),[[l,X.value.description]])]),e(`div`,L,[e(`button`,{type:`button`,onClick:$,class:`px-4 py-2 text-gray-600 hover:text-gray-800`},` Cancel `),e(`button`,R,c(G.value?`Create`:`Update`),1)])],32)])])):t(``,!0),q.value?(i(),n(`div`,pe,[e(`div`,z,[e(`h3`,B,` Manage Permissions for `+c(J.value?.name),1),e(`div`,me,[(i(!0),n(u,null,a(W.value,t=>(i(),n(`div`,{key:t.id,class:`flex items-center space-x-2`},[o(e(`input`,{id:`permission-${t.id}`,"onUpdate:modelValue":s[3]||=e=>Y.value=e,value:t.id,type:`checkbox`,class:`rounded border-gray-300 text-blue-600 focus:ring-blue-500`},null,8,he),[[ae,Y.value]]),e(`label`,{for:`permission-${t.id}`,class:`text-sm text-gray-700`},c(t.name),9,ge)]))),128))]),e(`div`,_e,[e(`button`,{onClick:s[4]||=e=>q.value=!1,class:`px-4 py-2 text-gray-600 hover:text-gray-800`},` Cancel `),e(`button`,{onClick:Ce,class:`px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600`},` Save Permissions `)])])])):t(``,!0)])])]))}};var H=re(V,[[`__scopeId`,`data-v-42359795`]]);export{H as default};