import{A as e,C as t,D as n,E as ee,G as r,H as i,I as te,J as a,K as ne,L as o,N as s,O as c,P as l,Q as u,S as d,d as re,l as ie,o as f,p as ae,s as p,t as m,v as oe,w as h,y as g,z as _}from"./index-DtN-fcwp.js";import{b as se}from"./useDarkMode-BFH4b8fl.js";import{b as ce}from"./MegaSearch-8CFJ7-2e.js";import{b as le}from"./LanguageSwitcher-BGX9PX3v.js";const ue={class:`min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-300`},de={class:`bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700`},fe={class:`w-full px-[2%]`},pe={class:`flex justify-between items-center h-16`},me={class:`flex items-center space-x-4`},he={class:`hidden md:block w-80`},ge={key:0,class:`h-5 w-5`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`},_e={key:1,class:`h-5 w-5`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`},v={class:`w-full py-8 px-[2%]`},y={class:`mb-6`},b={class:`bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8`},x={class:`relative`},S={key:0,class:`absolute z-10 w-full mt-1 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg max-h-60 overflow-auto`},C=[`onMousedown`],w={class:`font-medium text-gray-900 dark:text-white`},T={class:`text-sm text-gray-500 dark:text-gray-400`},E={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},D={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},O={class:`space-y-4`},k=[`value`],A={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},j={key:0},M=[`value`],N={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},P={key:1},F=[`value`],I={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},ve={key:2,class:`p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg`},ye={class:`text-blue-700 dark:text-blue-300`},be={class:`pt-4`},xe=[`disabled`],Se={key:0,class:`flex items-center justify-center`},Ce={key:1},we={key:0,class:`p-4 bg-green-100 dark:bg-green-900 border border-green-400 dark:border-green-600 text-green-700 dark:text-green-300 rounded-lg`},Te={key:1,class:`p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-600 text-red-700 dark:text-red-300 rounded-lg`},Ee={__name:`NewBatchForm`,setup(Ee){let L=re(),De=ie(),{isDarkMode:Oe,toggleDarkMode:R}=se(),z=s({customer_id:``,unit_price:``,room_id:``,floor_id:``,zone_id:``}),B=c(``),V=c([]),H=c([]),U=c(null),W=c(!1),G=c([]),K=c([]),q=c([]),J=c(``),Y=c(!1),X=c({}),Z=c(``),Q=c(``);ee(async()=>{try{let[e,t]=await Promise.all([ae.getCustomers(),f.getStorageStructure()]);V.value=e.data.data.data,G.value=t.data.data}catch(e){console.error(`Error loading data:`,e)}});let $=()=>{if(!B.value.trim()){H.value=[];return}let e=B.value.toLowerCase();H.value=V.value.filter(t=>t.full_name.toLowerCase().includes(e)||t.cnic_number.toLowerCase().includes(e))},ke=e=>{U.value=e,z.customer_id=e.id,B.value=e.full_name,W.value=!1},Ae=()=>{setTimeout(()=>{W.value=!1},200)},je=()=>{if(z.floor_id=``,z.zone_id=``,K.value=[],q.value=[],J.value=``,z.room_id){let e=G.value.find(e=>e.id==z.room_id);e&&(K.value=e.floors)}},Me=()=>{if(z.zone_id=``,q.value=[],J.value=``,z.floor_id){let e=K.value.find(e=>e.id==z.floor_id);e&&(q.value=e.zones)}},Ne=()=>{if(z.room_id&&z.floor_id&&z.zone_id){let e=G.value.find(e=>e.id==z.room_id),t=K.value.find(e=>e.id==z.floor_id),n=q.value.find(e=>e.id==z.zone_id);e&&t&&n&&(J.value=`${e.name} - ${t.name} - ${n.name}`)}else J.value=``};a(()=>z.zone_id,Ne);let Pe=async()=>{if(Y.value=!0,X.value={},Z.value=``,Q.value=``,z.customer_id||(X.value.customer_id=`Please select a customer`),(!z.unit_price||z.unit_price<=0)&&(X.value.unit_price=`Please enter a valid unit price`),z.room_id||(X.value.room_id=`Please select a room`),z.floor_id||(X.value.floor_id=`Please select a floor`),z.zone_id||(X.value.zone_id=`Please select a zone`),Object.keys(X.value).length>0){Y.value=!1;return}try{await f.createBatch(z),Z.value=`Lot created successfully!`,Object.keys(z).forEach(e=>{z[e]=``}),B.value=``,U.value=null,K.value=[],q.value=[],J.value=``,setTimeout(()=>{L.push(`/dashboard`)},2e3)}catch(e){console.error(`Error creating batch:`,e),Q.value=e.response?.data?.message||`Failed to create lot. Please try again.`}finally{Y.value=!1}},Fe=()=>{De.logout(),L.push(`/login`)};return(ee,a)=>{let s=te(`router-link`);return r(),e(`div`,ue,[g(`nav`,de,[g(`div`,fe,[g(`div`,pe,[a[9]||=g(`div`,{class:`flex items-center`},[g(`div`,{class:`flex-shrink-0`},[g(`h1`,{class:`text-2xl font-bold text-gray-900 dark:text-white`},`A & S Cold Storage`)])],-1),g(`div`,me,[g(`div`,he,[n(ce)]),g(`button`,{onClick:a[0]||=(...e)=>l(R)&&l(R)(...e),class:`p-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors duration-200`},[l(Oe)?(r(),e(`svg`,_e,[...a[8]||=[g(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z`},null,-1)]])):(r(),e(`svg`,ge,[...a[7]||=[g(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z`},null,-1)]]))]),n(le),g(`button`,{onClick:Fe,class:`px-4 py-2 bg-gradient-to-r from-red-400 to-red-500 text-white rounded-lg hover:from-red-500 hover:to-red-600 transition-all duration-200 font-medium`},` Logout `)])])])]),g(`div`,v,[g(`div`,y,[n(s,{to:`/dashboard`,class:`inline-flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors duration-200`},{default:ne(()=>[...a[10]||=[g(`svg`,{class:`w-4 h-4 mr-2`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`},[g(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M10 19l-7-7m0 0l7-7m-7 7h18`})],-1),t(` Back to Dashboard `,-1)]]),_:1})]),a[22]||=g(`div`,{class:`text-center mb-8`},[g(`h2`,{class:`text-3xl font-bold text-gray-900 dark:text-white mb-2`},`Add New Lot`),g(`p`,{class:`text-gray-600 dark:text-gray-400`},`Create a new lot record for a customer`)],-1),g(`div`,b,[g(`form`,{onSubmit:oe(Pe,[`prevent`]),class:`space-y-6`},[g(`div`,null,[a[11]||=g(`label`,{for:`customer_search`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Customer * `,-1),g(`div`,x,[o(g(`input`,{"onUpdate:modelValue":a[1]||=e=>B.value=e,onInput:$,onFocus:a[2]||=e=>W.value=!0,onBlur:Ae,type:`text`,id:`customer_search`,class:u([`w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":X.value.customer_id}]),placeholder:`Search customer by name or CNIC...`},null,34),[[m,B.value]]),W.value&&H.value.length>0?(r(),e(`div`,S,[(r(!0),e(h,null,i(H.value,t=>(r(),e(`div`,{key:t.id,onMousedown:e=>ke(t),class:`px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer border-b border-gray-200 dark:border-gray-600 last:border-b-0`},[g(`div`,w,d(t.full_name),1),g(`div`,T,d(t.cnic_number),1)],40,C))),128))])):_(``,!0)]),X.value.customer_id?(r(),e(`p`,E,d(X.value.customer_id),1)):_(``,!0)]),g(`div`,null,[a[12]||=g(`label`,{for:`unit_price`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Unit Price (PKR) * `,-1),o(g(`input`,{"onUpdate:modelValue":a[3]||=e=>z.unit_price=e,type:`number`,step:`0.01`,min:`0`,id:`unit_price`,class:u([`w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":X.value.unit_price}]),placeholder:`Enter unit price in PKR`},null,2),[[m,z.unit_price]]),X.value.unit_price?(r(),e(`p`,D,d(X.value.unit_price),1)):_(``,!0)]),g(`div`,O,[a[20]||=g(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Storage Location *`,-1),g(`div`,null,[a[14]||=g(`label`,{for:`room_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Room * `,-1),o(g(`select`,{"onUpdate:modelValue":a[4]||=e=>z.room_id=e,onChange:je,id:`room_id`,class:u([`w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":X.value.room_id}])},[a[13]||=g(`option`,{value:``},`Select Room`,-1),(r(!0),e(h,null,i(G.value,t=>(r(),e(`option`,{key:t.id,value:t.id},d(t.name)+` (`+d(t.code)+`) - `+d(t.available_capacity)+` baskets available `,9,k))),128))],34),[[p,z.room_id]]),X.value.room_id?(r(),e(`p`,A,d(X.value.room_id),1)):_(``,!0)]),z.room_id?(r(),e(`div`,j,[a[16]||=g(`label`,{for:`floor_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Floor * `,-1),o(g(`select`,{"onUpdate:modelValue":a[5]||=e=>z.floor_id=e,onChange:Me,id:`floor_id`,class:u([`w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":X.value.floor_id}])},[a[15]||=g(`option`,{value:``},`Select Floor`,-1),(r(!0),e(h,null,i(K.value,t=>(r(),e(`option`,{key:t.id,value:t.id},d(t.name)+` - `+d(t.available_capacity)+` baskets available `,9,M))),128))],34),[[p,z.floor_id]]),X.value.floor_id?(r(),e(`p`,N,d(X.value.floor_id),1)):_(``,!0)])):_(``,!0),z.floor_id?(r(),e(`div`,P,[a[18]||=g(`label`,{for:`zone_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Zone * `,-1),o(g(`select`,{"onUpdate:modelValue":a[6]||=e=>z.zone_id=e,id:`zone_id`,class:u([`w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":X.value.zone_id}])},[a[17]||=g(`option`,{value:``},`Select Zone`,-1),(r(!0),e(h,null,i(q.value,t=>(r(),e(`option`,{key:t.id,value:t.id},d(t.name)+` (`+d(t.code)+`) - `+d(t.available_capacity)+` baskets available `,9,F))),128))],2),[[p,z.zone_id]]),X.value.zone_id?(r(),e(`p`,I,d(X.value.zone_id),1)):_(``,!0)])):_(``,!0),J.value?(r(),e(`div`,ve,[a[19]||=g(`h4`,{class:`font-medium text-blue-900 dark:text-blue-100 mb-2`},`Selected Storage Location:`,-1),g(`p`,ye,d(J.value),1)])):_(``,!0)]),g(`div`,be,[g(`button`,{type:`submit`,disabled:Y.value,class:`w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 px-6 rounded-lg hover:from-blue-600 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium`},[Y.value?(r(),e(`span`,Se,[...a[21]||=[g(`svg`,{class:`animate-spin -ml-1 mr-3 h-5 w-5 text-white`,xmlns:`http://www.w3.org/2000/svg`,fill:`none`,viewBox:`0 0 24 24`},[g(`circle`,{class:`opacity-25`,cx:`12`,cy:`12`,r:`10`,stroke:`currentColor`,"stroke-width":`4`}),g(`path`,{class:`opacity-75`,fill:`currentColor`,d:`M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z`})],-1),t(` Creating Lot... `,-1)]])):(r(),e(`span`,Ce,`Create Lot`))],8,xe)]),Z.value?(r(),e(`div`,we,d(Z.value),1)):_(``,!0),Q.value?(r(),e(`div`,Te,d(Q.value),1)):_(``,!0)],32)])]),a[23]||=g(`footer`,{class:`bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-16`},[g(`div`,{class:`max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8`},[g(`p`,{class:`text-center text-sm text-gray-500 dark:text-gray-400`},` Powered by Emeriosoft `)])],-1)])}}};var L=Ee;export{L as default};