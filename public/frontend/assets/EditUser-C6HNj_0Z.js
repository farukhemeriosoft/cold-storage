import{A as e,B as t,E as n,G as r,H as i,J as a,L as o,M as s,N as c,P as l,Q as u,T as d,X as f,c as p,d as m,e as h,l as g,u as _,v,w as y,y as b,z as x}from"./index-6BYkH0DY.js";const S={class:`edit-user`},C={class:`bg-white rounded-lg shadow-md p-6`},w={class:`flex justify-between items-center mb-6`},T={key:0,class:`text-center py-8`},E={class:`grid grid-cols-1 md:grid-cols-2 gap-6`},D=[`value`],O={class:`space-y-2`},k=[`id`,`value`],A=[`for`],j={class:`text-gray-500`},M={class:`grid grid-cols-1 md:grid-cols-2 gap-6`},N=[`value`],P=[`value`],F={class:`flex justify-end space-x-4 pt-6 border-t`},I=[`disabled`],L={__name:`EditUser`,setup(h){let L=m(),R=p(),z=g(),B=d(!0),V=d(!1),H=d(null),U=d([]),W=d({name:``,email:``,password:``,status:`active`,role_ids:[]}),G=e(()=>W.value.email?W.value.email.split(`@`)[0].toLowerCase().replace(/[^a-z0-9]/g,``):`N/A`),K=e(()=>H.value&&H.value.created_at?new Date(H.value.created_at).toLocaleDateString(`en-US`,{year:`numeric`,month:`long`,day:`numeric`}):`N/A`),q=e(()=>H.value&&H.value.updated_at?new Date(H.value.updated_at).toLocaleDateString(`en-US`,{year:`numeric`,month:`long`,day:`numeric`}):`N/A`),J=async()=>{try{let e=await fetch(`/api/user-management/${R.params.id}`,{headers:{Authorization:`Bearer ${z.token}`,"Content-Type":`application/json`}});if(e.ok){let t=await e.json();H.value=t.data,W.value={name:H.value.name,email:H.value.email,password:``,status:H.value.roles&&H.value.roles.length>0?`active`:`inactive`,role_ids:H.value.roles?H.value.roles.map(e=>e.id):[]}}else alert(`User not found`),L.push(`/user-management`)}catch(e){console.error(`Error loading user:`,e),alert(`Error loading user. Please check console for details.`),L.push(`/user-management`)}finally{B.value=!1}},Y=async()=>{try{let e=await fetch(`/api/user-management/roles/available`,{headers:{Authorization:`Bearer ${z.token}`,"Content-Type":`application/json`}}),t=await e.json();U.value=t.data}catch(e){console.error(`Error loading roles:`,e)}},X=async()=>{if(W.value.role_ids.length===0){alert(`Please select at least one role`);return}V.value=!0;try{let e={name:W.value.name,email:W.value.email,role_ids:W.value.role_ids};W.value.password&&(e.password=W.value.password);let t=await fetch(`/api/user-management/${R.params.id}`,{method:`PUT`,headers:{Authorization:`Bearer ${z.token}`,"Content-Type":`application/json`},body:JSON.stringify(e)});if(t.ok)alert(`User updated successfully!`),L.push(`/user-management`);else{let e=await t.json();alert(`Error: ${e.message||`Failed to update user`}`)}}catch(e){console.error(`Error updating user:`,e),alert(`Error updating user. Please check console for details.`)}finally{V.value=!1}};return a(async()=>{await Promise.all([J(),Y()])}),(e,a)=>{let d=c(`router-link`);return o(),n(`div`,S,[t(`div`,C,[t(`div`,w,[a[6]||=t(`h2`,{class:`text-2xl font-bold text-gray-800`},`Edit User`,-1),i(d,{to:`/user-management`,class:`bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors`},{default:l(()=>[...a[5]||=[r(` Back to Users `,-1)]]),_:1})]),B.value?(o(),n(`div`,T,[...a[7]||=[t(`div`,{class:`inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500`},null,-1),t(`p`,{class:`mt-2 text-gray-600`},`Loading user data...`,-1)]])):(o(),n(`form`,{key:1,onSubmit:b(X,[`prevent`]),class:`space-y-6`},[t(`div`,E,[t(`div`,null,[a[8]||=t(`label`,{class:`block text-sm font-medium text-gray-700 mb-2`},` Full Name * `,-1),u(t(`input`,{"onUpdate:modelValue":a[0]||=e=>W.value.name=e,type:`text`,required:``,class:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500`,placeholder:`Enter full name`},null,512),[[y,W.value.name]])]),t(`div`,null,[a[9]||=t(`label`,{class:`block text-sm font-medium text-gray-700 mb-2`},` Email Address * `,-1),u(t(`input`,{"onUpdate:modelValue":a[1]||=e=>W.value.email=e,type:`email`,required:``,class:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500`,placeholder:`Enter email address`},null,512),[[y,W.value.email]])]),t(`div`,null,[a[10]||=t(`label`,{class:`block text-sm font-medium text-gray-700 mb-2`},` User ID `,-1),t(`input`,{value:G.value,type:`text`,disabled:``,class:`w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-500`,placeholder:`Auto-generated`},null,8,D),a[11]||=t(`p`,{class:`text-xs text-gray-500 mt-1`},`User ID is auto-generated from email`,-1)]),t(`div`,null,[a[12]||=t(`label`,{class:`block text-sm font-medium text-gray-700 mb-2`},` Password `,-1),u(t(`input`,{"onUpdate:modelValue":a[2]||=e=>W.value.password=e,type:`password`,class:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500`,placeholder:`Leave blank to keep current password`},null,512),[[y,W.value.password]]),a[13]||=t(`p`,{class:`text-xs text-gray-500 mt-1`},`Leave blank to keep current password`,-1)]),t(`div`,null,[a[15]||=t(`label`,{class:`block text-sm font-medium text-gray-700 mb-2`},` Account Status `,-1),u(t(`select`,{"onUpdate:modelValue":a[3]||=e=>W.value.status=e,class:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500`},[...a[14]||=[t(`option`,{value:`active`},`Active`,-1),t(`option`,{value:`inactive`},`Inactive`,-1)]],512),[[v,W.value.status]])]),t(`div`,null,[a[16]||=t(`label`,{class:`block text-sm font-medium text-gray-700 mb-2`},` Assign Role * `,-1),t(`div`,O,[(o(!0),n(x,null,s(U.value,e=>(o(),n(`div`,{key:e.id,class:`flex items-center`},[u(t(`input`,{id:`role-${e.id}`,"onUpdate:modelValue":a[4]||=e=>W.value.role_ids=e,value:e.id,type:`checkbox`,class:`rounded border-gray-300 text-blue-600 focus:ring-blue-500`},null,8,k),[[_,W.value.role_ids]]),t(`label`,{for:`role-${e.id}`,class:`ml-2 text-sm text-gray-700`},[r(f(e.name)+` `,1),t(`span`,j,`(`+f(e.description)+`)`,1)],8,A)]))),128))])])]),t(`div`,M,[t(`div`,null,[a[17]||=t(`label`,{class:`block text-sm font-medium text-gray-700 mb-2`},` Member Since `,-1),t(`input`,{value:K.value,type:`text`,disabled:``,class:`w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-500`},null,8,N)]),t(`div`,null,[a[18]||=t(`label`,{class:`block text-sm font-medium text-gray-700 mb-2`},` Last Updated `,-1),t(`input`,{value:q.value,type:`text`,disabled:``,class:`w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-500`},null,8,P)])]),t(`div`,F,[i(d,{to:`/user-management`,class:`px-6 py-2 text-gray-600 hover:text-gray-800 transition-colors`},{default:l(()=>[...a[19]||=[r(` Cancel `,-1)]]),_:1}),t(`button`,{type:`submit`,disabled:V.value,class:`px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors`},f(V.value?`Updating...`:`Update User`),9,I)])],32))])])}}};var R=h(L,[[`__scopeId`,`data-v-f6261f3f`]]);export{R as default};