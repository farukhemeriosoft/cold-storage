import{B as e,D as t,E as n,G as r,H as i,J as a,L as o,M as s,N as c,P as l,Q as u,S as d,T as f,V as p,X as m,d as h,l as g,n as _,p as v,w as y,y as b,z as x}from"./index-6BYkH0DY.js";import{b as S}from"./AppHeader-BKR7rNi1.js";import"./LanguageSwitcher-Bwn7UERh.js";import"./useBarcode-DHEpkZ5l.js";import{b as C}from"./BarcodeGenerator-X85SkKNG.js";const w={class:`min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-300`},T={class:`w-full py-8 px-[2%]`},E={class:`bg-white dark:bg-gray-800 rounded-xl shadow-elevated border border-gray-200 dark:border-gray-700`},D={class:`relative`},O={key:0,class:`absolute z-10 w-full mt-1 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg max-h-60 overflow-auto`},k=[`onMousedown`],A={class:`font-medium text-gray-900 dark:text-white`},j={class:`text-sm text-gray-500 dark:text-gray-400`},M={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},N={class:`mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg`},P={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},F={key:0,class:`p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg`},I={class:`text-green-800 dark:text-green-200 text-sm`},L={key:1,class:`p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg`},R={class:`text-red-800 dark:text-red-200 text-sm`},z={class:`flex justify-end space-x-4`},ee=[`disabled`],B={key:0,class:`flex items-center`},V={key:1},H={__name:`NewBasketForm`,setup(H){let U=h();g();let W=d({customer_id:``,barcode:``}),G=f(``),K=f([]),q=f([]),J=f(!1),Y=f(null),X=f(!1),Z=f({}),Q=f(``),$=f(``),te=async()=>{try{let e=await v.getCustomers(1),t=e.data.data||e.data;K.value=t.data||t||[]}catch(e){console.error(`Error loading customers:`,e)}},ne=()=>{if(G.value.length<2){q.value=[];return}let e=G.value.toLowerCase();q.value=K.value.filter(t=>t.full_name.toLowerCase().includes(e)||t.cnic_number.toLowerCase().includes(e)||t.phone_number.includes(e))},re=e=>{Y.value=e,G.value=e.full_name,W.customer_id=e.id,J.value=!1},ie=()=>{setTimeout(()=>{J.value=!1},200)},ae=async()=>{if(X.value=!0,Z.value={},Q.value=``,$.value=``,W.customer_id||(Z.value.customer_id=`Please select a customer`),W.barcode.trim()||(Z.value.barcode=`Please enter a barcode`),Object.keys(Z.value).length>0){X.value=!1;return}try{await _.createBasket(W),Q.value=`Basket created successfully!`,Object.keys(W).forEach(e=>{W[e]=``}),G.value=``,Y.value=null,setTimeout(()=>{U.push(`/dashboard`)},2e3)}catch(e){console.error(`Error creating basket:`,e),e.response?.data?.message?$.value=e.response.data.message:e.response?.data?.errors?Z.value=e.response.data.errors:$.value=`Failed to create basket. Please try again.`}finally{X.value=!1}};return a(()=>{te()}),(a,d)=>{let f=c(`router-link`);return o(),n(`div`,w,[i(S,{"show-back":!0}),e(`div`,T,[e(`div`,E,[d[10]||=e(`div`,{class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},[e(`h2`,{class:`text-2xl font-bold text-gray-900 dark:text-white`},`Add New Basket`),e(`p`,{class:`mt-1 text-sm text-gray-600 dark:text-gray-400`},`Create a new basket for a customer`)],-1),e(`form`,{onSubmit:b(ae,[`prevent`]),class:`p-6 space-y-6`},[e(`div`,null,[d[5]||=e(`label`,{for:`customer_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Customer * `,-1),e(`div`,D,[u(e(`input`,{"onUpdate:modelValue":d[0]||=e=>G.value=e,onInput:ne,onFocus:d[1]||=e=>J.value=!0,onBlur:ie,type:`text`,placeholder:`Search for a customer...`,class:p([`w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":Z.value.customer_id}])},null,34),[[y,G.value]]),J.value&&q.value.length>0?(o(),n(`div`,O,[(o(!0),n(x,null,s(q.value,t=>(o(),n(`div`,{key:t.id,onMousedown:e=>re(t),class:`px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-600 cursor-pointer border-b border-gray-100 dark:border-gray-600 last:border-b-0`},[e(`div`,A,m(t.full_name),1),e(`div`,j,` CNIC: `+m(t.cnic_number)+` | Phone: `+m(t.phone_number),1)],40,k))),128))])):t(``,!0)]),Z.value.customer_id?(o(),n(`p`,M,m(Z.value.customer_id),1)):t(``,!0)]),e(`div`,N,[d[6]||=e(`h3`,{class:`text-lg font-medium text-blue-900 dark:text-blue-100 mb-3`},` 🏷️ Auto-Generate Barcode `,-1),i(C,{modelValue:W.barcode,"onUpdate:modelValue":d[2]||=e=>W.barcode=e,onBarcodeSelected:d[3]||=e=>W.barcode=e},null,8,[`modelValue`])]),e(`div`,null,[d[7]||=e(`label`,{for:`barcode`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Barcode * `,-1),u(e(`input`,{"onUpdate:modelValue":d[4]||=e=>W.barcode=e,type:`text`,id:`barcode`,class:p([`w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors duration-200`,{"border-red-500":Z.value.barcode}]),placeholder:`Enter barcode or use auto-generation above`},null,2),[[y,W.barcode]]),Z.value.barcode?(o(),n(`p`,P,m(Z.value.barcode),1)):t(``,!0)]),Q.value?(o(),n(`div`,F,[e(`p`,I,m(Q.value),1)])):t(``,!0),$.value?(o(),n(`div`,L,[e(`p`,R,m($.value),1)])):t(``,!0),e(`div`,z,[i(f,{to:`/dashboard`,class:`px-6 py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},{default:l(()=>[...d[8]||=[r(` Cancel `,-1)]]),_:1}),e(`button`,{type:`submit`,disabled:X.value,class:`px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg hover:from-blue-600 hover:to-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200`},[X.value?(o(),n(`span`,B,[...d[9]||=[e(`svg`,{class:`animate-spin -ml-1 mr-3 h-5 w-5 text-white`,xmlns:`http://www.w3.org/2000/svg`,fill:`none`,viewBox:`0 0 24 24`},[e(`circle`,{class:`opacity-25`,cx:`12`,cy:`12`,r:`10`,stroke:`currentColor`,"stroke-width":`4`}),e(`path`,{class:`opacity-75`,fill:`currentColor`,d:`M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z`})],-1),r(` Creating... `,-1)]])):(o(),n(`span`,V,`Create Basket`))],8,ee)])],32)])])])}}};var U=H;export{U as default};